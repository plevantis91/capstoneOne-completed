<!-- home.html -->

{% extends 'base.html' %}

{% block title %}Login Page{% endblock %}

{% block content %}
        <div class="mt-4">
            <h1>Welcome, {{ username }}</h1>
            <p>Explore recipes and enjoy!</p>
        </div>
        <h1>Liked Recipes</h1>
    <table id="recipesTable" class="table table-striped table-bordered">
        <thead class="thead dark">
            <tr>
                <th>Title</th>
                <th>Description</th>
                <th>Image</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <!-- Rows will be inserted here by JavaScript -->
        </tbody>
    </table>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
    axios.get('/liked_recipes')
        .then(response => {
            const recipes = response.data;
            const tableBody = document.getElementById('recipesTable').querySelector('tbody');
            
            recipes.forEach(recipe => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${recipe.title}</td>
                    <td>${recipe.description || ''}</td>
                    <td><img src="${recipe.image || ''}" alt="${recipe.title}" style="max-width: 100px;"></td>
                    <td><button class="delete-btn" data-id="${recipe.id}">Delete</button></td>
                `;
                tableBody.appendChild(row);
            });

            // Add event listeners to delete buttons
            document.querySelectorAll('.delete-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const recipeId = this.getAttribute('data-id');
                    axios.post('/delete_recipe', { id: recipeId })
                        .then(response => {
                            if (response.data.success) {
                                this.closest('tr').remove();
                            } else {
                                alert('Error deleting recipe');
                            }
                        })
                        .catch(error => {
                            console.error('There was an error deleting the recipe:', error);
                        });
                });
            });
        })
        .catch(error => {
            console.error('Error fetching liked recipes:', error);
        });
});

    </script>

{% endblock %}
